<Window x:Class="Crosspose.Dekompose.Gui.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Crosspose Dekompose"
        Height="600"
        Width="900"
        MinWidth="760"
        MinHeight="500"
        Background="{DynamicResource WindowBackground}"
        Loaded="OnLoaded">
    <DockPanel xmlns:ui="clr-namespace:Crosspose.Ui;assembly=Crosspose.Ui">
        <Menu DockPanel.Dock="Top" Background="{DynamicResource SidebarBackground}" Foreground="{DynamicResource TextPrimary}">
            <Menu.Resources>
                <Style TargetType="MenuItem">
                    <Setter Property="Background" Value="{DynamicResource SidebarBackground}" />
                    <Setter Property="Foreground" Value="{DynamicResource TextPrimary}" />
                    <Setter Property="BorderBrush" Value="{DynamicResource SidebarBackground}" />
                </Style>
            </Menu.Resources>
            <MenuItem Header="_File">
                <MenuItem Header="_Quit" Click="OnExitClick" />
            </MenuItem>
                <MenuItem Header="_Tools">
                    <MenuItem Header="_Refresh Sources" Click="OnRefreshReposClick" />
                    <MenuItem Header="_Clear Log" Click="OnClearLogClick" />
                </MenuItem>
            <MenuItem Header="_Help">
                <MenuItem Header="_About" Click="OnAboutClick" />
            </MenuItem>
        </Menu>

        <Grid Margin="16" RowDefinitions="Auto,Auto,Auto,Auto,Auto,*,Auto,Auto,Auto,Auto">
            <TextBlock Text="Select chart source" FontSize="18" FontWeight="Bold" Grid.Row="0" Foreground="{DynamicResource TextPrimary}" />

            <Grid Grid.Row="1" Margin="0,12,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="150" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <TextBlock Text="Chart source" VerticalAlignment="Center" Foreground="{DynamicResource TextPrimary}" />
                <ComboBox Grid.Column="1"
                          x:Name="SourceCombo"
                          ItemsSource="{Binding ChartSources}"
                          DisplayMemberPath="Display"
                          SelectedItem="{Binding SelectedSource, Mode=TwoWay}"
                          SelectedIndex="-1"
                          IsEnabled="False"
                          HorizontalAlignment="Stretch"
                          Background="{DynamicResource InputBackground}"
                          Foreground="{DynamicResource TextPrimary}"
                          BorderBrush="{DynamicResource InputBorder}"
                          Margin="20,0,0,0" />
                <Button Grid.Column="2"
                        Content="+"
                        Width="28"
                        Height="26"
                        Margin="8,0,0,0"
                        Background="{DynamicResource AccentPositive}"
                        Foreground="White"
                        BorderBrush="{DynamicResource ButtonBorder}"
                        Click="OnAddSourceClick" />
            </Grid>

            <Grid Grid.Row="2" Margin="0,12,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="150" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <TextBlock Text="Chart" VerticalAlignment="Center" Foreground="{DynamicResource TextPrimary}" />
                <ComboBox Grid.Column="1"
                          x:Name="ChartCombo"
                          ItemsSource="{Binding Charts}"
                          DisplayMemberPath="Display"
                          SelectedItem="{Binding SelectedChart, Mode=TwoWay}"
                          SelectedIndex="-1"
                          IsEnabled="False"
                          HorizontalAlignment="Stretch"
                          Background="{DynamicResource InputBackground}"
                          Foreground="{DynamicResource TextPrimary}"
                          BorderBrush="{DynamicResource InputBorder}"
                          Margin="20,0,0,0" />
                <Button Grid.Column="2"
                        Content="..."
                        Width="28"
                        Height="26"
                        Margin="8,0,0,0"
                        Background="{DynamicResource ButtonBackground}"
                        Foreground="{DynamicResource ButtonForeground}"
                        BorderBrush="{DynamicResource ButtonBorder}"
                        Click="OnBrowseChartClick" />
            </Grid>

            <Grid Grid.Row="3" Margin="0,12,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="150" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <TextBlock Text="Version" VerticalAlignment="Center" Foreground="{DynamicResource TextPrimary}" />
                <ComboBox Grid.Column="1"
                          x:Name="VersionCombo"
                          ItemsSource="{Binding ChartVersions}"
                          DisplayMemberPath="Tag"
                          SelectedItem="{Binding SelectedVersion, Mode=TwoWay}"
                          SelectedIndex="-1"
                          IsEnabled="False"
                          HorizontalAlignment="Stretch"
                          Background="{DynamicResource InputBackground}"
                          Foreground="{DynamicResource TextPrimary}"
                          BorderBrush="{DynamicResource InputBorder}"
                          Margin="20,0,0,0" />
            </Grid>

            <Grid Grid.Row="4" Margin="0,12,0,6">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="150" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Row="0"
                           Text="Values file"
                           VerticalAlignment="Center"
                           Foreground="{DynamicResource TextPrimary}" />
                <Button Grid.Row="0"
                        Grid.Column="1"
                        Content="Load values file..."
                        Margin="20,0,0,0"
                        Click="OnLoadValuesClick"
                        Background="{DynamicResource ButtonBackground}"
                        Foreground="{DynamicResource ButtonForeground}"
                        BorderBrush="{DynamicResource ButtonBorder}" />

                <TextBlock Grid.Row="1"
                           Grid.Column="1"
                           Text="{Binding ValuesHeader}"
                           Foreground="{DynamicResource TextMuted}"
                           Margin="20,6,0,0" />

                <TextBlock Grid.Row="2"
                           Text="Dekompose file"
                           VerticalAlignment="Center"
                           Foreground="{DynamicResource TextPrimary}"
                           Margin="0,12,0,0" />
                <Button Grid.Row="2"
                        Grid.Column="1"
                        Content="Load dekompose file..."
                        Margin="20,12,0,0"
                        Click="OnLoadDekomposeConfigClick"
                        Background="{DynamicResource ButtonBackground}"
                        Foreground="{DynamicResource ButtonForeground}"
                        BorderBrush="{DynamicResource ButtonBorder}" />

                <TextBlock Grid.Row="3"
                           Grid.Column="1"
                           Text="{Binding DekomposeHeader}"
                           Foreground="{DynamicResource TextMuted}"
                           Margin="20,6,0,0" />
            </Grid>

            <TextBox Grid.Row="5"
                     x:Name="ValuesText"
                     Text="{Binding ValuesContent, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                     AcceptsReturn="True"
                     Background="{DynamicResource InputBackground}"
                     Foreground="{DynamicResource TextPrimary}"
                     BorderBrush="{DynamicResource InputBorder}"
                     VerticalScrollBarVisibility="Auto"
                     FontFamily="Consolas" />

            <Grid Grid.Row="6" Margin="0,8,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="150" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <TextBlock Text="Options"
                           VerticalAlignment="Center"
                           Foreground="{DynamicResource TextPrimary}" />
                <StackPanel Grid.Column="1"
                            Orientation="Horizontal"
                            Margin="20,0,0,0"
                            VerticalAlignment="Center">
                    <CheckBox Content="Compression"
                              IsChecked="{Binding CompressOutput, Mode=TwoWay}"
                              Foreground="{DynamicResource TextPrimary}" />
                    <CheckBox Content="Infra"
                              Margin="24,0,0,0"
                              IsChecked="{Binding IncludeInfraEstimates, Mode=TwoWay}"
                              Foreground="{DynamicResource TextPrimary}" />
                    <CheckBox Content="Remap Ports"
                              Margin="24,0,0,0"
                              IsChecked="{Binding RemapServicePorts, Mode=TwoWay}"
                              Foreground="{DynamicResource TextPrimary}" />
                </StackPanel>
            </Grid>

            <Grid Grid.Row="7" Margin="0,12,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="150" />
                    <ColumnDefinition Width="20" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <TextBlock Text="Output directory" VerticalAlignment="Center" Foreground="{DynamicResource TextPrimary}" />
                <TextBox Grid.Column="2"
                         Text="{Binding OutputDirectory, Mode=TwoWay}"
                         HorizontalAlignment="Stretch"
                         Background="{DynamicResource InputBackground}"
                         Foreground="{DynamicResource TextPrimary}"
                         BorderBrush="{DynamicResource InputBorder}" />
                <Button Grid.Column="3" Content="..." Width="30" Click="OnBrowseOutputClick"
                        Background="{DynamicResource ButtonBackground}"
                        Foreground="{DynamicResource ButtonForeground}"
                        BorderBrush="{DynamicResource ButtonBorder}" />
            </Grid>

            <Grid Grid.Row="8" Margin="0,12,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="150" />
                    <ColumnDefinition Width="20" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Button Content="Dekompose" Width="150" Click="OnDekomposeClick"
                        Background="{DynamicResource AccentPositive}"
                        Foreground="White"
                        BorderBrush="{DynamicResource ButtonBorder}" />
                <TextBlock Grid.Column="2"
                           Text="{Binding StatusMessage}"
                           Foreground="{DynamicResource TextMuted}"
                           VerticalAlignment="Center" />
            </Grid>

            <ui:LogViewerControl Grid.Row="9"
                                 Margin="0,12,0,0"
                                 LogText="{Binding LogOutput, Mode=OneWay}"
                                 ClearRequested="OnLogClearRequested" />

            <Border Background="{DynamicResource OverlayMask}"
                    Visibility="{Binding IsBusy, Converter={StaticResource BoolToVis}}"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Stretch"
                    Grid.RowSpan="10">
                <TextBlock Text="{Binding BusyText}" FontSize="16" FontWeight="Bold"
                           HorizontalAlignment="Center" VerticalAlignment="Center"
                           Background="{DynamicResource OverlayTextBackground}"
                           Foreground="{DynamicResource TextPrimary}" />
            </Border>
        </Grid>
    </DockPanel>
</Window>
